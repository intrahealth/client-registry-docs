
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="Technical documentation for the Client Registry" name="description"/>
<link href="https://github.com/intrahealth/client-registry-docs/security/" rel="canonical"/>
<meta content="IntraHealth" name="author"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.0.4, mkdocs-material-4.6.0" name="generator"/>
<title>Security - Client Registry Documentation</title>
<link href="../assets/stylesheets/application.1b62728e.css" rel="stylesheet"/>
<link href="../assets/stylesheets/application-palette.a8b3c06d.css" rel="stylesheet"/>
<meta content="#546e7a" name="theme-color"/>
<script src="../assets/javascripts/modernizr.268332fc.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
<link href="../assets/fonts/material-icons.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="blue-grey" dir="ltr">
<svg class="md-svg">
<defs>
<svg height="448" id="__github" viewbox="0 0 416 448" width="416" xmlns="http://www.w3.org/2000/svg"><path d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" fill="currentColor"></path></svg>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#security" tabindex="1">
        Skip to content
      </a>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a class="md-header-nav__button md-logo" href="https://github.com/intrahealth/client-registry-docs" title="Client Registry Documentation">
<i class="md-icon"></i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
              Client Registry Documentation
            </span>
<span class="md-header-nav__topic">
              
                Security
              
            </span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-icon md-search__icon" for="__search"></label>
<button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
        
      </button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
            Type to start searching
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a class="md-source" data-md-source="github" href="https://github.com/intrahealth/client-registry-docs/" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    intrahealth/client-registry-docs
  </div>
</a>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container">
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="https://github.com/intrahealth/client-registry-docs" title="Client Registry Documentation">
<i class="md-icon"></i>
</a>
    Client Registry Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-source="github" href="https://github.com/intrahealth/client-registry-docs/" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    intrahealth/client-registry-docs
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href=".." title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../gettingstarted/" title="Getting Started">
      Getting Started
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      User Manual
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-3">
        User Manual
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../workflow/" title="Workflows">
      Workflows
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../decision_rules/" title="Decision Rules">
      Decision Rules
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../benchmarks/" title="Matching Benchmarks">
      Matching Benchmarks
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ui/" title="Admin Interface">
      Admin Interface
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dashboard/" title="Dashboard">
      Dashboard
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../resources/" title="Additional Resources">
      Additional Resources
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      Developer Manual
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-4">
        Developer Manual
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Security
      </label>
<a class="md-nav__link md-nav__link--active" href="./" title="Security">
      Security
    </a>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#user-authentication">
    User Authentication
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#node-authentication">
    Node Authentication
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#atna-logging">
    ATNA Logging
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#non-production">
    Non-Production
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../openmrs/" title="OpenMRS MPI Client">
      OpenMRS MPI Client
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../docker/" title="Docker">
      Docker
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../installation/" title="Installation (Lite)">
      Installation (Lite)
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../installation_full/" title="Installation (Production)">
      Installation (Production)
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../queries/" title="Example API Query (cURL)">
      Example API Query (cURL)
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../queriespy/" title="Example API Query (Python)">
      Example API Query (Python)
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../configuration/" title="Server Configuration">
      Server Configuration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../configurebenchmarks/" title="Configure Benchmarks">
      Configure Benchmarks
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../production/" title="Production Considerations">
      Production Considerations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../backup/" title="Backup and Recovery">
      Backup and Recovery
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../troubleshooting/" title="Troubleshooting">
      Troubleshooting
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../contributing/" title="Contributing">
      Contributing
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../about/" title="About">
      About
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#user-authentication">
    User Authentication
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#node-authentication">
    Node Authentication
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#atna-logging">
    ATNA Logging
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#non-production">
    Non-Production
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset"><a class="md-icon md-content__icon" download href="../pdf/combined.pdf" title="PDF Export"></a>
<a class="md-icon md-content__icon" href="https://github.com/intrahealth/client-registry-docs/edit/master/docs/security.md" title="Edit this page"></a>
<h1 id="security">Security<a class="headerlink" href="#security" title="Permanent link">¶</a></h1>
<p>It is difficult (and irresponsible) to try to explain all of the best practices in computer security. This page focuses on how security is addressed in the Open Client Registry. For links to information on server and network hardening and production best practices see the <a href="../production/">production</a> page.</p>
<p>Several areas are addressed, user authentication, node authentication, ATNA auditing, and non-production (demos, tests) configuration.</p>
<p>Secure Node
Any IHE actor which is capable of authenticating itself to other nodes and transmitting data securely.
Audit Repository
Responsible for the storage of audit events</p>
<p><a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol2a.pdf">IHE ITI</a></p>
<p>The IHE IT Infrastructure (ITI) domain addresses the implementation of standards-based interoperability solutions to improve information sharing, workflow and patient care.</p>
<h2 id="user-authentication">User Authentication<a class="headerlink" href="#user-authentication" title="Permanent link">¶</a></h2>
<h2 id="node-authentication">Node Authentication<a class="headerlink" href="#node-authentication" title="Permanent link">¶</a></h2>
<p>Authenticate Node [ITI-19]</p>
<h2 id="atna-logging">ATNA Logging<a class="headerlink" href="#atna-logging" title="Permanent link">¶</a></h2>
<p>Audit Trail and Node Authentication (ATNA) Integration Profile is </p>
<h2 id="non-production">Non-Production<a class="headerlink" href="#non-production" title="Permanent link">¶</a></h2>
<div class="codehilite"><pre><span></span><span class="c1"># create a private key with pem extension</span>
openssl req -newkey rsa:4096 -keyout dhis2_key.pem -out dhis2_csr.pem -nodes -days <span class="m">365</span> -subj <span class="s2">"/CN=dhis2"</span>
<span class="c1"># generate a </span>
openssl x509 -req -in dhis2_csr.pem -CA ../certificates/server_cert.pem -CAkey ../certificates/server_key.pem -out dhis2_cert.pem -set_serial <span class="m">01</span> -days <span class="m">36500</span>
<span class="c1"># </span>
openssl pkcs12 -export -in dhis2_cert.pem -inkey dhis2_key.pem -out dhis2.p12
</pre></div>
<p>The <code>.p12</code> filename extension is for <a href="https://en.wikipedia.org/wiki/PKCS_12">PKCS #12</a> file archives. PKCS #12 is for storing several cryptographic objects together including user-defined values. In the provided example .p12 files in the Client Registry repository, they include an X.509 (public key) certificate and a private key, and some information about the owner, including, for the Client Registry, the <code>subject</code>, meaning the name of the system (such as a specfic EMR POS system) that it was issued for.</p>
<p>A useful way to understand this better is to open one of the .p12 files using no password (hit enter) for the Import Password, and the subject name for the PEM pass phrase (in this example 'openmrs' without quotes and in lowercase).</p>
<p>When certificate is self-signed, then issuer and subject field contains the same value</p>
<div class="codehilite"><pre><span></span><span class="c1"># from client-registry/server/sampleclientcertificates</span>
$ openssl pkcs12 -info -in openmrs.p12
Enter Import Password:
MAC Iteration <span class="m">2048</span>
MAC verified OK
PKCS7 Encrypted data: pbeWithSHA1And40BitRC2-CBC, Iteration <span class="m">2048</span>
Certificate bag
Bag Attributes
    localKeyID: <span class="m">36</span> 7A <span class="m">50</span> BC 1C 0E <span class="m">69</span> <span class="m">93</span> <span class="m">22</span> 7F CC FB 4D <span class="m">07</span> C2 BE B2 <span class="m">37</span> <span class="m">02</span> C6
<span class="nv">subject</span><span class="o">=</span>/CN<span class="o">=</span>openmrs
<span class="nv">issuer</span><span class="o">=</span>/CN<span class="o">=</span>localhost/O<span class="o">=</span>Client Registry
-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----
PKCS7 Data
Shrouded Keybag: pbeWithSHA1And3-KeyTripleDES-CBC, Iteration <span class="m">2048</span>
Bag Attributes
    localKeyID: <span class="m">36</span> 7A <span class="m">50</span> BC 1C 0E <span class="m">69</span> <span class="m">93</span> <span class="m">22</span> 7F CC FB 4D <span class="m">07</span> C2 BE B2 <span class="m">37</span> <span class="m">02</span> C6
Key Attributes: &lt;No Attributes&gt;
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----BEGIN ENCRYPTED PRIVATE KEY-----
...
-----END ENCRYPTED PRIVATE KEY-----
</pre></div>
<p>the p12 is normally protected with a password and is not shared. It is imported in an application (e.g. a browser or a password manager) When a authentication must take place, the browser sends the identification information and its public key. The server then offers a challenge only the owner of the private key can solve. The browsers then sends back the solution of the challenge and the user is both identified and authenticated. Anyone getting access to the p12 will be able to impersonate the real owner.</p>
<hr/>
<div class="md-source-date">
<small>
                      
                        Last update: February 3, 2020
                      
                    </small>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="../resources/" rel="prev" title="Additional Resources">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Additional Resources
              </span>
</div>
</a>
<a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../openmrs/" rel="next" title="OpenMRS MPI Client">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                OpenMRS MPI Client
              </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2020 IntraHealth International
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/application.808e90bb.js"></script>
<script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
</body>
</html>